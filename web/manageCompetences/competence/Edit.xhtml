<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<ui:composition template="/template/template.xhtml">

    <ui:define name="top">
        <p:breadCrumb>
            <p:menuitem value="Inicio" url="/index.jsf"/>
            <p:menuitem value="Competencias" url="/manageCompetences/competence/List.jsf"/>
            <p:menuitem value="Crear" url="#"/>
        </p:breadCrumb>
    </ui:define>

    <ui:define name="title">
        <h:outputText value="#{bundle.CreateCompetenceTitle}"></h:outputText>
    </ui:define>

    <ui:define name="body">

        <h:form id="CompetenceCreateForm">
            <p:spacer width="100" height="10"/>

            <div class="ui-g-12 ui-fluid">

                <p:fieldset legend="#{bundle.competenceDataFieldSet}">

                    <div class="md-inputfield">
                        <p:inputText id="competitionName" value="#{competenceController.selected.competitionName}"
                                     title="#{bundle.CreateCompetenceTitle_competitionName}" required="true"
                                     requiredMessage="#{bundle.CreateCompetenceRequiredMessage_competitionName}"/>
                        <h:outputLabel value="#{bundle.CreateCompetenceLabel_competitionName}" for="competitionName"/>
                    </div>

                    <br/>

                    <div class="md-inputfield">

                        <p:inputTextarea id="description" rows="6" cols="33"
                                         autoResize="false" value="#{competenceController.selected.description}"
                                         title="#{bundle.CreateCompetenceTitle_description}" maxlength="300"
                                         counter="remainingChars"
                                         counterTemplate="{0} #{bundle.remainingChars}"
                                         required="true"
                                         requiredMessage="#{bundle.CreateCompetenceRequiredMessage_description}">

                        </p:inputTextarea>
                        <h:outputLabel value="#{bundle.CreateCompetenceLabel_description}" for="description"/>
                    </div>
                    <h:outputLabel id="remainingChars"/>

                    <div>
                        <br/>
                        <h:outputLabel value="#{bundle.CreateCompetenceLabel_technical}" for="technical"/>
                        <p:selectBooleanButton id="technical" value="#{competenceController.selected.technical}"
                                               onLabel="#{bundle.yesBooleanButton}" offLabel="#{bundle.noBooleanButton}"
                                               style="width:60px;margin-top: 0px!important" onIcon="ui-icon-check"
                                               offIcon="ui-icon-close"/>
                    </div>
                </p:fieldset>
            </div>

            <br/>

            <div class="ui-g-12 ui-fluid">
                <p:fieldset legend="#{bundle.lvlDimTableHeader}">
                    <div>
                        <h:outputLabel value="#{bundle.CreateCompetenceLevelLabel}" for="levelsFk"/>
                        <p:selectOneMenu effect="clip" id="levelsFk" value="#{levelsController.selected}"
                                         style="margin-bottom: 5px">
                            <f:selectItem itemLabel="#{bundle.selectOnePlaceHolder}"/>
                            <f:selectItems value="#{levelsController.itemsAvailableSelectOne}"
                                           var="levelItem"
                                           itemValue="#{levelItem}"
                                           itemLabel="#{levelItem.levels}->#{levelItem.significance}"/>
                            <p:ajax update="addDimCommandButton" event="itemSelect"
                                    listener="#{myCompetenceController.handleAddDimButton_Listener()}"/>
                        </p:selectOneMenu>
                    </div>

                    <br/>
                    <div class="md-inputfield">
                        <p:inputTextarea id="name" rows="6" cols="33"
                                         autoResize="false" value="#{myCompetenceController.dim}"
                                         title="#{bundle.CreateCompetenceTitle_description}" maxlength="300"
                                         counter="remainingChars2"
                                         counterTemplate="{0} #{bundle.remainingChars}"
                        >
                            <!--required="true" requiredMessage="#{bundle.CreateCompetenceRequiredMessage_description}"-->
                            <p:ajax update="addDimCommandButton" process="name" event="keyup"
                                    listener="#{myCompetenceController.handleAddDimButton_Listener()}"/>
                        </p:inputTextarea>
                        <h:outputLabel value="#{bundle.CreateCompetenceDimensionLabel_name}" for="name"/>
                    </div>
                    <h:outputLabel id="remainingChars2"/>


                    <div>
                        <br/>
                        <p:commandButton class="z-depth-1" id="addDimCommandButton"
                                         disabled="#{myCompetenceController.diableAddDimButton}" process="name"
                                         icon="ui-icon-plus" value="#{bundle.addDimButton}">
                            <p:ajax event="click" listener="#{myCompetenceController.addDimension_Listener}"
                                    update="addDimCommandButton,name,CompetenceCreateForm:selectedCompDim,:growl,#{p:component('saveBtn')}"/>
                        </p:commandButton>
                    </div>

                    <br/>

                    <div class="ui-g-12 ui-fluid">
                        <p:dataTable id="selectedCompDim"
                                     value="#{myCompetenceController.dimensions}"
                                     selection="#{myCompetenceController.dimensionsDelete}"
                                     style="margin-bottom:0"
                                     var="dimSelection"
                                     rowKey="#{dimSelection.name}"
                        >
                            <f:facet name="header">
                                #{bundle.lvlDimTableHeader}
                            </f:facet>

                            <p:ajax event="rowSelect" update="deleteDimButton"/>
                            <p:ajax event="rowUnselect" update="deleteDimButton"/>
                            <p:ajax event="rowSelectCheckbox" update="deleteDimButton"/>
                            <p:ajax event="rowUnselectCheckbox" update="deleteDimButton"/>
                            <p:ajax event="toggleSelect" update="deleteDimButton"/>

                            <p:column selectionMode="multiple" style="width:16px;text-align:center"/>

                            <p:column headerText="#{bundle.CreateCompetenceLevelLabel}"
                                      filterBy="#{dimSelection.levelFk.levels}" sortBy="#{dimSelection.levelFk.levels}">
                                #{dimSelection.levelFk.levels}
                            </p:column>

                            <p:column headerText="#{bundle.CreateCompetenceLevelLabel_significance}"
                                      filterBy="#{dimSelection.levelFk.significance}"
                                      sortBy="#{dimSelection.levelFk.significance}">
                                #{dimSelection.levelFk.significance}
                            </p:column>

                            <p:column headerText="#{bundle.compDimNameColumnHeader}" filterBy="#{dimSelection.name}"
                                      sortBy="#{dimSelection.name}">
                                #{dimSelection.name}
                            </p:column>

                            <f:facet name="footer">
                                <p:commandButton class="z-depth-1" id="deleteDimButton" type="button"
                                                 process="selectedCompDim" icon="ui-icon-trash"
                                                 value="#{bundle.quitSelectedCompetence}"
                                                 disabled="#{empty myCompetenceController.dimensionsDelete}">
                                    <p:ajax event="click" update="selectedCompDim"
                                            listener="#{myCompetenceController.delDimension_Listener}"/>
                                </p:commandButton>
                            </f:facet>
                        </p:dataTable>
                    </div>
                </p:fieldset>
            </div>

            <p:spacer width="100" height="20"/>

            <p:panelGrid columns="2" columnClasses="ui-grid-col-2" styleClass="ui-panelgrid-blank">
                <p:commandButton id="saveBtn" class="z-depth-1" actionListener="#{myCompetenceController.create}"
                                 value="#{bundle.Save}" update="@form,:growl"
                                 disabled="#{empty myCompetenceController.validateCreate()}"/>
                <p:commandButton class="z-depth-1" value="#{bundle.Cancel}" action="to-competence-list"
                                 immediate="true"/>
            </p:panelGrid>


        </h:form>

    </ui:define>
</ui:composition>
</html>

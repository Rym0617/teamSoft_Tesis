<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->

<!--by jpinas-->
<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
>
    <style>
        .foo {
            vertical-align: top;
        }
    </style>
    <h:form id="formConfComp">
        <div class="ui-g ui-fluid">
            <div class="ui-g-12 ui-fluid">
                <p:fieldset legend="#{bundle.valores_a_config}">
                    <p:panelGrid columns="3" styleClass="ui-noborder">
                        <p:panelGrid columns="1" cellpadding="2" styleClass="foo">
                            <p:panelGrid columns="2" cellpadding="5">
                                <p:outputLabel for="comboTexto"
                                               rendered="#{not empty stepConfCompetences.getKeysOfTextAtributes()}"
                                               value="#{bundle.label_atributo_texto}"
                                />
                                <p:selectOneMenu id="comboTexto"
                                                 value="#{stepConfCompetences.selectedAssignedText}"
                                                 style="width:100%"
                                                 rendered="#{not empty stepConfCompetences.getKeysOfTextAtributes()}"
                                >
                                    <f:selectItems
                                            value="#{stepConfCompetences.getKeysOfTextAtributes()}"
                                            var="atrC"
                                            itemLabel="#{atrC}"
                                            itemValue="#{atrC}"
                                    />
                                    <p:ajax event="change"
                                            update="@all"
                                    />
                                </p:selectOneMenu>
                            </p:panelGrid>

                            <p:dataTable id="tableSelectedTexto" var="assignedText"
                                         value="#{stepConfCompetences.getValuesOfSelectedText(
                                         stepConfCompetences.selectedAssignedText
                                         )}"
                                         draggableRows="true"
                                         reflow="true"
                                         rendered="#{not empty stepConfCompetences.getKeysOfTextAtributes()}"
                            >
                                <p:ajax event="rowReorder"
                                        listener="#{stepConfCompetences.onRowReorder(stepConfCompetences.selectedAssignedText)}"
                                        process="@this" update="@all"
                                />
                                <f:facet name="header">
                                    <p:outputLabel value="#{bundle.table_text_value_header}"/>
                                </f:facet>

                                <p:columnGroup type="header">
                                    <p:row>
                                        <p:column
                                                headerText="#{bundle.table_asignados_column_header_atributo}"
                                        />
<!--                                        <p:column headerText="d"/>-->
                                    </p:row>
                                </p:columnGroup>

                                <p:column>
                                    <h:outputText value="#{assignedText.valorDentroFichero}"/>
                                </p:column>

<!--                                <p:column>-->
<!--                                    <h:outputText value="#{assignedText.peso}"/>-->
<!--                                </p:column>-->
                            </p:dataTable>
                        </p:panelGrid>

                        <p:panelGrid columns="1" cellpadding="2" styleClass="foo">
                            <p:panelGrid columns="2" cellpadding="5">
                                <p:outputLabel for="comboTexto"
                                               rendered="#{not empty stepConfCompetences.getKeysOfCompetence()}"
                                               value="#{bundle.competences_more_one_value}"
                                />
                                <p:selectOneMenu id="comboCompValue"
                                                 value="#{stepConfCompetences.selectedCompetence}"
                                                 style="width:100%"
                                                 rendered="#{not empty stepConfCompetences.getKeysOfCompetence()}"
                                >
                                    <f:selectItems
                                            value="#{stepConfCompetences.getKeysOfCompetence()}"
                                            var="compVal"
                                            itemLabel="#{compVal}"
                                            itemValue="#{compVal}"
                                    />
                                    <p:ajax event="change"
                                            update="@all"
                                    />
                                </p:selectOneMenu>
                            </p:panelGrid>

                            <p:dataTable id="tableCompetenceAtrValue" var="compAtr"
                                         value="#{stepConfCompetences.getValuesOfSelectedCompetence(
                                                                         stepConfCompetences.selectedCompetence
                                                                         )}"
                                         editable="true"
                                         editMode="cell"
                                         reflow="true"
                                         rendered="#{not empty stepConfCompetences.getKeysOfCompetence()}"
                            >
                                <f:facet name="header">
                                    <p:outputLabel value="#{bundle.table_text_value_header}"/>
                                </f:facet>

                                <p:columnGroup type="header">
                                    <p:row>
                                        <p:column
                                                headerText="#{bundle.table_asignados_column_header_atributo}"
                                        />
                                        <p:column id="valorCompAtr">
                                            <f:facet name="header">
                                                <h:outputText
                                                        value="#{bundle.label_peso}"/>
                                                <p:tooltip value="#{bundle.table_column_tooltip_campo_persona}"
                                                           for="valorCompAtr"
                                                           position="top"/>
                                            </f:facet>
                                        </p:column>
                                    </p:row>
                                </p:columnGroup>

                                <p:column>
                                    <h:outputText value="#{compAtr.atributo}"/>
                                </p:column>

                                <p:column id="colPesoAtr">
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText
                                                    value="#{compAtr.peso}" id="outputAtr"/>
                                        </f:facet>
                                        <f:facet name="input">
                                            <p:inputNumber id="inputoutputAtr"
                                                           value="#{compAtr.peso}"
                                                           minValue="0.00" maxValue="1.00"
                                            >
                                                <p:ajax update="@all"/>
                                            </p:inputNumber>
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>

                                <p:columnGroup type="footer">
                                    <p:row>
                                        <p:column footerText="#{bundle.label_suma_total}"
                                                  style="text-align:right"/>
                                        <p:column
                                                footerText="#{stepConfCompetences.getSumOfValuesCompetenceAtr()}"
                                                style="text-align: center"/>
                                    </p:row>
                                </p:columnGroup>

                            </p:dataTable>
                        </p:panelGrid>

                        <p:panelGrid columns="1" cellpadding="5" styleClass="foo">
                            <p:outputLabel rendered="#{not empty stepConfCompetences.getAtributosAsignadosNumero()}"
                                           value="#{bundle.max_valor_numerico}"
                            />

                            <p:dataTable id="tableAtrNum" var="atrValue"
                                         value="#{stepConfCompetences.atributosAsignadosNumero}"
                                         editable="true"
                                         editMode="cell"
                                         reflow="true"
                                         rendered="#{not empty stepConfCompetences.getAtributosAsignadosNumero()}"
                            >
                                <f:facet name="header">
                                    <p:outputLabel value="#{bundle.table_text_value_header}"/>
                                </f:facet>

                                <p:columnGroup type="header">
                                    <p:row>
                                        <p:column headerText="#{bundle.table_disponibles_column_header}"/>
                                        <p:column id="valorAtrMax">
                                            <f:facet name="header">
                                                <h:outputText value="#{bundle.max_value}"/>
                                                <p:tooltip value="#{bundle.tooltip_max_value}"
                                                           for="valorAtrMax"
                                                           position="top"/>
                                            </f:facet>
                                        </p:column>
                                    </p:row>
                                </p:columnGroup>

                                <p:column>
                                    <h:outputText value="#{atrValue.fileAtribute}"/>
                                </p:column>

                                <p:column id="colPesoMaxValAtr">
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText id="labelValor"
                                                          value="#{atrValue.maximoValor}"/>
                                        </f:facet>
                                        <f:facet name="input">
                                            <p:inputNumber value="#{atrValue.maximoValor}"
                                                           minValue="1" maxValue="1000"
                                            >
                                                <p:ajax update="labelValor"/>
                                            </p:inputNumber>
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>

                            </p:dataTable>
                        </p:panelGrid>
                    </p:panelGrid>

                </p:fieldset>
            </div>
        </div>
    </h:form>
</ui:composition>